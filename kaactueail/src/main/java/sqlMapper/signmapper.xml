<?xml version="1.0" encoding="UTF-8"?>
<!-- signmapper.xml  DML 명령 처리 -->
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
 	"http://mybatis.org/dtd/mybatis-3-mapper.dtd"> 
 	
 <mapper namespace="memberdao">
 	
 	<!-- <select id="selectAll"  resultType="memberdto">
 		select * from mybatisBoard order by seq desc
 	</select> -->
 	 
 	 <!-- 회원가입 -->
 	 <insert id="insertmember"   parameterType="memberdto">
 	 	INSERT INTO MEMBER VALUE(M_NUM, M_ID, M_PWD, M_NAME, M_TEL,M_BIRTH, M_ROLE)
 	 	VALUES(#{m_num}, #{m_id},#{m_pwd},#{m_name},#{m_tel} ,#{m_birth}, 'ROLE_USER')
 	 </insert>
 	                                               
 	 <!-- 회원번호 중복체크 -->
 	 <select id = "selectmnum" parameterType="int" resultType="int">
 	 	SELECT COUNT(*) FROM MEMBER WHERE M_NUM = #{m_num}
 	 </select>
 	 
 	 <!-- 아이디 비밀번호 체크(로그인)  -->
 	 <select id = "checkmember" parameterType="memberdto" resultType="boolean">
 	 	SELECT COUNT(*) FROM MEMBER WHERE M_ID = #{m_id} AND M_PWD=#{m_pwd}
 	 </select>
 	 
 	 <!-- 로그인한 사용자 권한 가져오기 -->
 	 <select id="memberrole" parameterType = "String" resultType = "String">
 	 	SELECT M_ROLE FROM MEMBER WHERE M_ID = #{m_id}
 	 </select>
 	 
 	 <!-- 로그인한 사용자 회원번호 가져오기 -->
 	 <select id="membernum" parameterType = "String" resultType = "int">
 	 	SELECT M_NUM FROM MEMBER WHERE M_ID = #{m_id}
 	 </select>
 	 
 	 <!-- <delete id="delete" parameterType="int">
 	 	DELETE FROM MYBATISBOARD WHERE SEQ = #{SEQ}
 	 </delete>
 	 
 	 <select id="detailList"  resultType="memberdto"  parameterType="int">
 	 	select * from mybatisBoard where seq = #{seq}
 	 </select>
 	 
 	  <update id="update" parameterType="memberdto">
    	UPDATE mybatisBoard
    		SET title=#{title} , writer=#{writer} , content=#{content} 	
    		WHERE seq = #{seq}
    </update>
    
     <select id="selectSearch" parameterType="hashMap" resultType="memberdto">
    	 
    		 1. Java 코드
    		 Map<String, String> map = new HashMap<>(); //collection
      		 map.put("column",column ); //column : title or writer or content
      		 map.put("keyvalue", keyvalue); //keyvalue : 김연아
             
             2. 함수 호출시 
             session.selectList("GUEST.selectSearch" ,map);
    	
    	     3. xml에서 
    		 parameterType="hashMap"
    		
    		map key   : column , keyvalue
    		map value : #{column} , ${column}
    		
    		Tip : ${column} : 컬럼명
    	
    	
    	SELECT * FROM mybatisBoard
    	where writer like '%김연아%'
    	<if test="column != null">
    		where ${column} like '%' || #{keyvalue} || '%'    	
    	</if>
    </select>
    
     <select id="selectSearch2" parameterType="hashMap" resultType="memberdto">
    	SELECT * FROM mybatisBoard
    	<where>
    		<if test="name != null">
    			title = #{keyvalue}
    		</if>
    	    <if test="email != null">
    	    	or writer = #{keyvalue}
    	    </if>
			<if test="home != null">
				or content = #{keyvalue}
			</if>    	
    	</where>    	
    </select> -->
 	 
 </mapper>